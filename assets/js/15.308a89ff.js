(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{372:function(s,e,n){"use strict";n.r(e);var a=n(42),t=Object(a.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h3",{attrs:{id:"uc3"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#uc3"}},[s._v("#")]),s._v(" uc3")]),s._v(" "),n("p",[s._v("umask")]),s._v(" "),n("p",[s._v("指定文件没有那些权限")]),s._v(" "),n("p",[s._v("新创建文件的权限等于mode&~umask")]),s._v(" "),n("div",{staticClass:"language-eg line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("\nmode  rwx,rw_,rw_ 766\numask ___,___,_w_ 002\n创建的文件的权限位。  rwx,rw,r__\n\nmode        111,110,110\n\numask取反    111，111，101\n\n与的结果     111，110，100  ==  rwx,rw,r__\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("查看当前进程的umask.")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("umask \n022\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("设置进程的umask")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("umask 042\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("ul",[n("li",[s._v("返回值：")])]),s._v(" "),n("p",[s._v("If successful, open() returns a non-negative integer, termed a file descriptor.  It returns -1 on failure, and sets errno to indicate the error.")]),s._v(" "),n("p",[s._v("进程：进程的本质是程序执行过程中，对计算机资源的使用情况的描述，类似于视频是由一幅幅图片连起来的。")]),s._v(" "),n("p",[s._v("文件描述符（a non-negative integer, termed a file descriptor）的本质：\n每个进程都有一个pid来标识，pid对应的进程信息存在内核中的pcb（process contril block）中.是一个结构体，结构体中会把进程运行时使用的文件资源存在一个file结构体数组的字段中。当进程打开一个文件时，会把当前数组中未占用的最小数组下标返回。这个数组的下标就是文件描述符。pcb位于内核中，还会记录进程对其他计算机资源的使用。")]),s._v(" "),n("p",[n("img",{attrs:{src:"/clang/file.png",alt:"cb60ac2581291b05e14f27ce1c3ae538"}})]),s._v(" "),n("p",[s._v("bash中启动的进程的012文件描述符被占用了。")]),s._v(" "),n("p",[s._v("0 标准输入 键盘 对应的宏 STDIN_FILENO")]),s._v(" "),n("p",[s._v("1 标准输出 显示器 STDOUT_FILENO")]),s._v(" "),n("p",[s._v("2 标准错误输出 显示器 STDERR_FILENO")]),s._v(" "),n("p",[s._v("2.关闭文件")]),s._v(" "),n("p",[s._v("#include <unistd.h>")]),s._v(" "),n("p",[s._v("int close(int fildes);")]),s._v(" "),n("p",[s._v("功能：delete a descriptor")]),s._v(" "),n("p",[s._v("返回值：\nUpon successful completion, a value of 0 is returned.Otherwise, a value of -1 is returned and the global integer variable errno is set to indicate the error.")]),s._v(" "),n("p",[s._v("3.读文件的内容")]),s._v(" "),n("p",[s._v("#include <unistd.h>")]),s._v(" "),n("p",[s._v("ssize_t\nread(int fildes, void *buf, size_t nbyte);")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("功能：\nread() attempts to read nbyte bytes of data from the object referenced by the descriptor fildes into the buffer pointed to by buf.")])]),s._v(" "),n("li",[n("p",[s._v("参数：\nfildes 指向读取文件的文件描述符")])])]),s._v(" "),n("p",[s._v("buf 读取文件到缓冲区")]),s._v(" "),n("p",[s._v("size_t 代表要读区的字节数")]),s._v(" "),n("ul",[n("li",[s._v("返回值")])]),s._v(" "),n("p",[s._v("成功返回读取到的字节数，返回0代表到达文件的末尾\n失败返回-1，errorn被设置")]),s._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[s._v("写入文件的内容\ninclude <unistd.h>\nssize_t\nwrite(int fildes, const void *buf, size_t nbyte);")])]),s._v(" "),n("ul",[n("li",[s._v("功能\nwrite() attempts to write nbyte of data to the object referenced by the\ndescriptor fildes from the buffer pointed to by buf.")]),s._v(" "),n("li",[s._v("参数")])]),s._v(" "),n("p",[s._v("fildes 要写入的文件描述符")]),s._v(" "),n("p",[s._v("buf 将buf中的写到文件中")]),s._v(" "),n("p",[s._v("nbyte 写入的字节数")]),s._v(" "),n("ul",[n("li",[s._v("返回值")])]),s._v(" "),n("p",[s._v("Upon successful completion the number of bytes which were written is returned.  Otherwise, a -1 is returned and the global variable errno is set to indicate the error.")]),s._v(" "),n("p",[s._v("返回值为0时不为错，可能磁盘满了。")]),s._v(" "),n("p",[s._v("5.修改文件的偏移")]),s._v(" "),n("p",[s._v("#include <unistd.h>")]),s._v(" "),n("p",[s._v("off_t lseek(int fildes, off_t offset, int whence);")]),s._v(" "),n("ul",[n("li",[s._v("功能")])]),s._v(" "),n("p",[s._v("The lseek() function repositions the offset of the file descriptor fildes to the argument offset, according to the directive whence.  The argument fildes must be an open file descriptor.  lseek() repositions the file\npointer fildes as follows:\nIf whence is SEEK_SET, the offset is set to offset bytes.")]),s._v(" "),n("p",[s._v("If whence is SEEK_CUR, the offset is set to its current location plus offset bytes.")]),s._v(" "),n("p",[s._v("If whence is SEEK_END, the offset is set to the size of the file plus offset bytes.")]),s._v(" "),n("ul",[n("li",[s._v("参数")])]),s._v(" "),n("p",[s._v("fildes 指定文件描述符只想的文件的偏移")]),s._v(" "),n("p",[s._v("off_t  指定偏移多少个字节数")]),s._v(" "),n("p",[s._v("whence 偏移的开始，可以为SEEK_SET（文件的开始），SEEK_CUR（当前偏移位置），SEEK_END（文件的结尾）")]),s._v(" "),n("ul",[n("li",[s._v("返回值\noff_t 代表最终的相对文件开始位置的偏移量。")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("以指定类型(x1 = 16进制) c(ascii)形式显示文件的内容\n$ od -tx1  -tc hello.txt\n0000000    68  65  6c  6c  6f  20  77  6f  72  6c  64  21  0a            \n           h   e   l   l   o       w   o   r   l   d   !  \\n            \n0000015\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("6.将文件映射到虚拟地址")]),s._v(" "),n("p",[s._v("代码：map_file.c")]),s._v(" "),n("p",[s._v("7.复制文件描述符")]),s._v(" "),n("p",[s._v("文件描述符是pcb快中保存引用文件的结构体数组的下标，复制文件描述符使两个文件描述符指向同一个文件。利用这个可以输出文件重定向。")]),s._v(" "),n("p",[s._v("#include <unistd.h>")]),s._v(" "),n("p",[s._v("int\ndup(int fildes);")]),s._v(" "),n("p",[s._v("int\ndup2(int fildes, int fildes2);")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("功能：\ndup复制一个文件描述符，返回一个新的文件描述符，这个文件描述符是当前进程文件描述符表中的最小索引。\ndup2复制一个文件描述符到指定的描述符，如果指定文件描述符被使用的话，系统会先关闭这个文件引用在区复制。")])]),s._v(" "),n("li",[n("p",[s._v("返回值")])])]),s._v(" "),n("p",[s._v("Upon successful completion, the new file descriptor is returned.  Other-wise, a value of -1 is returned and the global integer variable errno is set to indicate the error.")]),s._v(" "),n("p",[s._v("成功返回文件描述符，失败返回-1，errno被设置。")]),s._v(" "),n("h4",{attrs:{id:"文件的元数据-meta"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#文件的元数据-meta"}},[s._v("#")]),s._v(" 文件的元数据（meta）")]),s._v(" "),n("p",[s._v("每个文件都有一个inode结构体(inode又自己的编号)，这个结构体存放了文件的元数据和文件内容所在块的编号，一个inode可以对应多个文件。一个块包含磁盘上的多个扇区（一般是4个），每个扇区的大小是512个字节。\n"),n("img",{attrs:{src:"/clang/inode.png",alt:"16215cc36d11afc861f873e8e621645c"}})]),s._v(" "),n("p",[s._v("查看文件的inode编号")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -li\n\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1573616")]),s._v(" -rwxr-xr-x  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" yiluhuakai yiluhuakai  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8648")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":53 a.out\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("第一个参数代表的是文件的inode编号。")]),s._v(" "),n("p",[s._v("硬链接")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("yiluhuakai@debian:~/oc$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" hello.m  hello\nyiluhuakai@debian:~/oc$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -li\n总用量 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1589381")]),s._v(" -rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" yiluhuakai yiluhuakai "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("190")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" 00:10 hello\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1589381")]),s._v(" -rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" yiluhuakai yiluhuakai "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("190")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" 00:10 hello.m\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("硬链接相当于给文件一个别名，两个文件名对应一个inode.文件权限旁边的数字代表的是硬链接的个数。")]),s._v(" "),n("p",[s._v("软连接")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("yiluhuakai@debian:~/oc$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s hello.m hello.c\nyiluhuakai@debian:~/oc$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nhello  hello.c  hello.m\nyiluhuakai@debian:~/oc$ "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" -li\n总用量 "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1589381")]),s._v(" -rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" yiluhuakai yiluhuakai "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("190")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" 00:10 hello\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1589359")]),s._v(" lrwxrwxrwx "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" yiluhuakai yiluhuakai   "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("31")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(":05 hello.c -"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" hello.m\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1589381")]),s._v(" -rw-r--r-- "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" yiluhuakai yiluhuakai "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("190")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("月  "),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(" 00:10 hello.m\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("p",[s._v("软件接文件和原文件的inode是不同的。软连接的inode中块编号保存的是硬链接文件的名称。通过名称可以找源文件的inode,然后访问磁盘上对应位置的内容，所以用cat打印文件的内容，看到的结果是一样的。")]),s._v(" "),n("h4",{attrs:{id:"查看文件的元信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看文件的元信息"}},[s._v("#")]),s._v(" 查看文件的元信息")]),s._v(" "),n("p",[s._v("#include <sys/types.h>\n#include <sys/stat.h>\n#include <unistd.h>\nint stat(const char *pathname, struct stat *buf);")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("函数作用\nThese functions return information about a file, in the buffer pointed to by buf.")])]),s._v(" "),n("li",[n("p",[s._v("参数\npath 文件名\nbuf  返回文件元信息的结构体")])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("struct stat {\n               dev_t     st_dev;         /* ID of device containing file */\n               ino_t     st_ino;         /* inode number */\n               mode_t    st_mode;        /* file type and mode */\n               nlink_t   st_nlink;       /* number of hard links */\n               uid_t     st_uid;         /* user ID of owner */\n               gid_t     st_gid;         /* group ID of owner */\n               dev_t     st_rdev;        /* device ID (if special file) */\n               off_t     st_size;        /* total size, in bytes */\n               blksize_t st_blksize;     /* blocksize for filesystem I/O */\n               blkcnt_t  st_blocks;      /* number of 512B blocks allocated */\n\n               /* Since Linux 2.6, the kernel supports nanosecond\n                  precision for the following timestamp fields.\n                  For the details before Linux 2.6, see NOTES. */\n\n               struct timespec st_atim;  /* time of last access */\n               struct timespec st_mtim;  /* time of last modification */\n               struct timespec st_ctim;  /* time of last status change */\n\n           #define st_atime st_atim.tv_sec      /* Backward compatibility */\n           #define st_mtime st_mtim.tv_sec\n           #define st_ctime st_ctim.tv_sec\n           };\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br")])]),n("ul",[n("li",[s._v("返回值")])]),s._v(" "),n("p",[s._v("On success, zero is returned.  On error, -1 is returned, and errno is set appropriately.")]),s._v(" "),n("ul",[n("li",[s._v("上面的结构体中定义了宏变量，用来代表另一个结构体的字段")])]),s._v(" "),n("p",[s._v("代码参见 : file_message/t_stat.c")]),s._v(" "),n("h3",{attrs:{id:"uid和gid"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#uid和gid"}},[s._v("#")]),s._v(" uid和gid")]),s._v(" "),n("p",[s._v("uid和gid是系统中标示用户和用户组的，我们一般看到的和使用的是用户和用户组的名字。")]),s._v(" "),n("p",[s._v("linux下查看用户的相关信息")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/passwd"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" root\nroot:x:0:0:root:/root:/bin/bash\n"),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/passwd"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" bruce\nbruce:x:1000:1000:bruce,,,:/home/bruce:/bin/bash\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br")])]),n("p",[s._v("冒号是分隔符。\n第一列代表用户名，第二列是否有密码，第三列代表了uid,第四列是gid,第五列是用户的信息，第六列是用户的家目录，第七列是用户登陆时执行的第一个程序。")]),s._v(" "),n("p",[s._v("linux下查看用户组信息")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/group"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" bruce\nadm:x:4:syslog,bruce\ncdrom:x:24:bruce\nsudo:x:27:bruce\ndip:x:30:bruce\nplugdev:x:46:bruce\nlpadmin:x:120:bruce\nlxd:x:131:bruce\nbruce:x:1000:\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("冒号是分隔符，第一列是用户的用户组名，第二列代表是否有密码，第三列代表用户组id,第四列是用户成员。")]),s._v(" "),n("h3",{attrs:{id:"获取用户信息和用户组信息"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取用户信息和用户组信息"}},[s._v("#")]),s._v(" 获取用户信息和用户组信息")]),s._v(" "),n("p",[s._v("#include <sys/types.h>\n#include <pwd.h>")]),s._v(" "),n("p",[s._v("struct passwd *getpwuid(uid_t uid);")]),s._v(" "),n("ul",[n("li",[s._v("功能")])]),s._v(" "),n("p",[s._v("The getpwuid() function returns a pointer to a structure containing the\nbroken-out  fields  of the record in the password database that matches the user ID uid.")]),s._v(" "),n("ul",[n("li",[s._v("参数 uid(用户组id)")]),s._v(" "),n("li",[s._v("返回值")])]),s._v(" "),n("p",[s._v("成功返回paswd结构体指针，失败返回NULL,errorn被设置。")]),s._v(" "),n("p",[s._v("passwd结构体：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v("struct "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n               char   *pw_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("       /* username */\n               char   *pw_passwd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("     /* user password */\n               uid_t   pw_uid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("        /* user ID */\n               gid_t   pw_gid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("        /* group ID */\n               char   *pw_gecos"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("      /* user information */\n               char   *pw_dir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("        /* home directory */\n               char   *pw_shell"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("      /* shell program */\n           "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("p",[s._v("#include <sys/types.h>\n#include <grp.h>")]),s._v(" "),n("p",[s._v("struct group *getgrgid(gid_t gid);")]),s._v(" "),n("ul",[n("li",[s._v("返回用户组的信息")]),s._v(" "),n("li",[s._v("参数用户组id")]),s._v(" "),n("li",[s._v("返回值\n成功返回group结构体的指针，失败返回NULL,errorn被设置。")])]),s._v(" "),n("p",[s._v("group结构体：")]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[s._v(" struct group "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n               char   *gr_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("        /* group name */\n               char   *gr_passwd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("      /* group password */\n               gid_t   gr_gid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("         /* group ID */\n               char  **gr_mem"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("         /* NULL-terminated array of pointers\n                                          to names of group members */\n           "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h3",{attrs:{id:"时间相关的函数"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#时间相关的函数"}},[s._v("#")]),s._v(" 时间相关的函数")]),s._v(" "),n("p",[s._v("#include <time.h>\nchar *ctime(const time_t *timep);")]),s._v(" "),n("ul",[n("li",[s._v("描述")])]),s._v(" "),n("p",[s._v("毫秒数转成时间戳字符串")]),s._v(" "),n("ul",[n("li",[n("p",[s._v("参数\ntimep是距离1970.1.1的毫秒数变量的地址")])]),s._v(" "),n("li",[n("p",[s._v("返回值")])])]),s._v(" "),n("p",[s._v("成功返回时间戳，失败返回NULL.")]),s._v(" "),n("h3",{attrs:{id:"查看文件的权限"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#查看文件的权限"}},[s._v("#")]),s._v(" 查看文件的权限")]),s._v(" "),n("p",[s._v("stat函数返回的结构体中包含文件的权限（st_mode），st_mode返回一个无符号整型。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# 八进制显示\nmode of file:100664\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("10代表文件的类型，0代表文件的三个可执行权限组成的权限，后面的9位代表文件的权限。可以在man 7 inode中查看。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("The following mask values are defined for the file type:\n\n           S_IFMT     0170000   bit mask for the file type bit field\n\n           S_IFSOCK   0140000   socket\n           S_IFLNK    0120000   symbolic link\n           S_IFREG    0100000   regular file\n           S_IFBLK    0060000   block device\n           S_IFDIR    0040000   directory\n           S_IFCHR    0020000   character device\n           S_IFIFO    0010000   FIFO\n\n       Thus, to test for a regular file (for example), one could write:\n\n           stat(pathname, &sb);\n           if ((sb.st_mode & S_IFMT) == S_IFREG) {\n               /* Handle regular file */\n           }\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("p",[s._v("将文件的权限和S_IFMT 与可以取得文件类型。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("#最前面的0代表9进制\nst_mode 0100664 ->(2进制)001 000 110 110 100 \nS_IFMT  0170000        001 111 000 000 000     \n\n按位与  010000          001 000 000 000 000\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br")])]),n("p",[s._v("与会除了文件类型的位置，其他位置的字段都是0，然后与对应的宏进行比较，得到的就是文件的类型。")]),s._v(" "),n("p",[s._v("The following mask values are defined for the file mode component of the st_mode field:")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("S_ISUID     04000   set-user-ID bit (see execve(2))\n           S_ISGID     02000   set-group-ID bit (see below)\n           S_ISVTX     01000   sticky bit (see below)\n\n           S_IRWXU     00700   owner has read, write, and execute permission\n           S_IRUSR     00400   owner has read permission\n           S_IWUSR     00200   owner has write permission\n           S_IXUSR     00100   owner has execute permission\n\n           S_IRWXG     00070   group has read, write, and execute permission\n           S_IRGRP     00040   group has read permission\n           S_IWGRP     00020   group has write permission\n           S_IXGRP     00010   group has execute permission\n\n           S_IRWXO     00007   others (not in group) have read,  write,  and\n                               execute permission\n           S_IROTH     00004   others have read permission\n           S_IWOTH     00002   others have write permission\n           S_IXOTH     00001   others have execute permission\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br")])]),n("p",[s._v("检测用户组是否有可读权限且将它以字符的形的形式输出。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("st.st_mode & S_IRUSR ?'r':'_'\nst.st_mode & S_IWUSR ?'w':'_'\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])])])}),[],!1,null,null,null);e.default=t.exports}}]);