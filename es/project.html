<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端工程化 | yiluhuakai</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.775e5fee.css" as="style"><link rel="preload" href="/assets/js/app.6fb23a83.js" as="script"><link rel="preload" href="/assets/js/2.b22280cb.js" as="script"><link rel="preload" href="/assets/js/40.6405a5c2.js" as="script"><link rel="prefetch" href="/assets/js/10.40461a30.js"><link rel="prefetch" href="/assets/js/11.d103858e.js"><link rel="prefetch" href="/assets/js/12.4232f768.js"><link rel="prefetch" href="/assets/js/13.b3734304.js"><link rel="prefetch" href="/assets/js/14.f2386497.js"><link rel="prefetch" href="/assets/js/15.308a89ff.js"><link rel="prefetch" href="/assets/js/16.db389cec.js"><link rel="prefetch" href="/assets/js/17.cf828fcb.js"><link rel="prefetch" href="/assets/js/18.899e9438.js"><link rel="prefetch" href="/assets/js/19.580699e9.js"><link rel="prefetch" href="/assets/js/20.332c8709.js"><link rel="prefetch" href="/assets/js/21.375795c8.js"><link rel="prefetch" href="/assets/js/22.50502a93.js"><link rel="prefetch" href="/assets/js/23.687897f9.js"><link rel="prefetch" href="/assets/js/24.ebc77e7a.js"><link rel="prefetch" href="/assets/js/25.337c6ea9.js"><link rel="prefetch" href="/assets/js/26.e762b5ea.js"><link rel="prefetch" href="/assets/js/27.13464cd3.js"><link rel="prefetch" href="/assets/js/28.523d766a.js"><link rel="prefetch" href="/assets/js/29.3987be3f.js"><link rel="prefetch" href="/assets/js/3.de1a5954.js"><link rel="prefetch" href="/assets/js/30.ff074f82.js"><link rel="prefetch" href="/assets/js/31.44d32a6e.js"><link rel="prefetch" href="/assets/js/32.b9b36b40.js"><link rel="prefetch" href="/assets/js/33.abe84780.js"><link rel="prefetch" href="/assets/js/34.2fb44918.js"><link rel="prefetch" href="/assets/js/35.a3098855.js"><link rel="prefetch" href="/assets/js/36.05c89a1c.js"><link rel="prefetch" href="/assets/js/37.27eda115.js"><link rel="prefetch" href="/assets/js/38.1dff405e.js"><link rel="prefetch" href="/assets/js/39.35c28552.js"><link rel="prefetch" href="/assets/js/4.e26bf81a.js"><link rel="prefetch" href="/assets/js/41.34a3cdb8.js"><link rel="prefetch" href="/assets/js/42.18986dd4.js"><link rel="prefetch" href="/assets/js/43.7fdfe078.js"><link rel="prefetch" href="/assets/js/44.283ea1af.js"><link rel="prefetch" href="/assets/js/45.6778b0eb.js"><link rel="prefetch" href="/assets/js/46.c9d8e532.js"><link rel="prefetch" href="/assets/js/47.74ec33ae.js"><link rel="prefetch" href="/assets/js/48.e6419c54.js"><link rel="prefetch" href="/assets/js/49.a850af05.js"><link rel="prefetch" href="/assets/js/5.ce8ed43a.js"><link rel="prefetch" href="/assets/js/50.7a85f1c4.js"><link rel="prefetch" href="/assets/js/51.e050e509.js"><link rel="prefetch" href="/assets/js/52.4e95e579.js"><link rel="prefetch" href="/assets/js/53.2c1823d9.js"><link rel="prefetch" href="/assets/js/54.dd273805.js"><link rel="prefetch" href="/assets/js/55.ef337569.js"><link rel="prefetch" href="/assets/js/56.f0e79429.js"><link rel="prefetch" href="/assets/js/57.eab487a7.js"><link rel="prefetch" href="/assets/js/58.3060e802.js"><link rel="prefetch" href="/assets/js/59.a7db315a.js"><link rel="prefetch" href="/assets/js/6.a3856d53.js"><link rel="prefetch" href="/assets/js/60.99117954.js"><link rel="prefetch" href="/assets/js/61.805588a2.js"><link rel="prefetch" href="/assets/js/62.bb5d85a6.js"><link rel="prefetch" href="/assets/js/7.02b760da.js"><link rel="prefetch" href="/assets/js/8.78eceb25.js"><link rel="prefetch" href="/assets/js/9.196b0b91.js">
    <link rel="stylesheet" href="/assets/css/0.styles.775e5fee.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">yiluhuakai</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/leetcode/" class="nav-link">
  LeetCode
</a></div><div class="nav-item"><a href="/golang/" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/mysql/" class="nav-link">
  Mysql
</a></div><div class="nav-item"><a href="/clang/" class="nav-link">
  C语言
</a></div><div class="nav-item"><a href="/es/" class="nav-link router-link-active">
  前端
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/leetcode/" class="nav-link">
  LeetCode
</a></div><div class="nav-item"><a href="/golang/" class="nav-link">
  Go
</a></div><div class="nav-item"><a href="/mysql/" class="nav-link">
  Mysql
</a></div><div class="nav-item"><a href="/clang/" class="nav-link">
  C语言
</a></div><div class="nav-item"><a href="/es/" class="nav-link router-link-active">
  前端
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/es/const_let.html" class="sidebar-link">let和const</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/es/obj.html" class="sidebar-link">对象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/obj.html#对象字面量的增强" class="sidebar-link">对象字面量的增强</a></li><li class="sidebar-sub-header"><a href="/es/obj.html#object-assign" class="sidebar-link">Object.assign</a></li><li class="sidebar-sub-header"><a href="/es/obj.html#object-is" class="sidebar-link">Object.is</a></li><li class="sidebar-sub-header"><a href="/es/obj.html#proxy" class="sidebar-link">Proxy</a></li><li class="sidebar-sub-header"><a href="/es/obj.html#reflect" class="sidebar-link">Reflect</a></li><li class="sidebar-sub-header"><a href="/es/obj.html#promise" class="sidebar-link">Promise</a></li><li class="sidebar-sub-header"><a href="/es/obj.html#class" class="sidebar-link">Class</a></li></ul></li><li><a href="/es/func.html" class="sidebar-link">函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/func.html#默认值参数" class="sidebar-link">默认值参数</a></li><li class="sidebar-sub-header"><a href="/es/func.html#剩余参数" class="sidebar-link">剩余参数</a></li><li class="sidebar-sub-header"><a href="/es/func.html#数组的解构" class="sidebar-link">数组的解构</a></li><li class="sidebar-sub-header"><a href="/es/func.html#箭头函数" class="sidebar-link">箭头函数</a></li></ul></li><li><a href="/es/string.html" class="sidebar-link">ES中的模版字符串</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/string.html#es中的模版字符串" class="sidebar-link">ES中的模版字符串</a></li><li class="sidebar-sub-header"><a href="/es/string.html#es2015中新增的关于操作字符串的方法" class="sidebar-link">ES2015中新增的关于操作字符串的方法</a></li></ul></li><li><a href="/es/set_map.html" class="sidebar-link">set 和 map</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/set_map.html#set" class="sidebar-link">set</a></li><li class="sidebar-sub-header"><a href="/es/set_map.html#map" class="sidebar-link">map</a></li></ul></li><li><a href="/es/deconstruction.html" class="sidebar-link">解构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/deconstruction.html#数组的解构" class="sidebar-link">数组的解构</a></li><li class="sidebar-sub-header"><a href="/es/deconstruction.html#对象的解构" class="sidebar-link">对象的解构</a></li><li class="sidebar-sub-header"><a href="/es/deconstruction.html#字符串的解构" class="sidebar-link">字符串的解构</a></li></ul></li><li><a href="/es/Symbol.html" class="sidebar-link">Symbol</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/es/for_of.html" class="sidebar-link">for..of 和迭代器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/for_of.html#for-of-和迭代器" class="sidebar-link">for..of 和迭代器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/for_of.html#for-of-循环" class="sidebar-link">for ... of 循环</a></li><li class="sidebar-sub-header"><a href="/es/for_of.html#迭代器模式和迭代器" class="sidebar-link">迭代器模式和迭代器</a></li><li class="sidebar-sub-header"><a href="/es/for_of.html#生成器函数" class="sidebar-link">生成器函数</a></li></ul></li></ul></li><li><a href="/es/es2016_17.html" class="sidebar-link">ES2016和ES2017新特性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/es2016_17.html#es2016和es2017新特性" class="sidebar-link">ES2016和ES2017新特性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/es2016_17.html#es2016" class="sidebar-link">ES2016</a></li><li class="sidebar-sub-header"><a href="/es/es2016_17.html#es2017" class="sidebar-link">ES2017</a></li></ul></li></ul></li><li><a href="/es/Ts.html" class="sidebar-link">TypeScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/Ts.html#typescript" class="sidebar-link">TypeScript</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/Ts.html#强类型和弱类型" class="sidebar-link">强类型和弱类型</a></li><li class="sidebar-sub-header"><a href="/es/Ts.html#typescript简介" class="sidebar-link">TypeScript简介</a></li><li class="sidebar-sub-header"><a href="/es/Ts.html#typescript上手" class="sidebar-link">TypeScript上手</a></li><li class="sidebar-sub-header"><a href="/es/Ts.html#ts的原始类型" class="sidebar-link">ts的原始类型</a></li><li class="sidebar-sub-header"><a href="/es/Ts.html#中文错误消息" class="sidebar-link">中文错误消息</a></li><li class="sidebar-sub-header"><a href="/es/Ts.html#ts作用域问题" class="sidebar-link">TS作用域问题</a></li><li class="sidebar-sub-header"><a href="/es/Ts.html#ts中的类型注解" class="sidebar-link">TS中的类型注解</a></li><li class="sidebar-sub-header"><a href="/es/Ts.html#ts的polyfill-垫片" class="sidebar-link">TS的polyfill(垫片)</a></li><li class="sidebar-sub-header"><a href="/es/Ts.html#在vue项目中加入ts-https-cn-vuejs-org-v2-guide-typescript-html" class="sidebar-link">[在vue项目中加入ts]（https://cn.vuejs.org/v2/guide/typescript.html）</a></li><li class="sidebar-sub-header"><a href="/es/Ts.html#标注-prop" class="sidebar-link" style="padding-left:3rem;">标注 Prop</a></li><li class="sidebar-sub-header"><a href="/es/Ts.html#再已有的js项目中加入类型验https-cloud-tencent-com-developer-article-1006180" class="sidebar-link">再已有的JS项目中加入类型验https://cloud.tencent.com/developer/article/1006180</a></li></ul></li></ul></li><li><a href="/es/flow.html" class="sidebar-link">flow</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/flow.html#flow" class="sidebar-link">flow</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/flow.html#flow的使用" class="sidebar-link">flow的使用</a></li><li class="sidebar-sub-header"><a href="/es/flow.html#flow的语法规则" class="sidebar-link">flow的语法规则</a></li><li class="sidebar-sub-header"><a href="/es/flow.html#flow类型文档" class="sidebar-link">flow类型文档</a></li><li class="sidebar-sub-header"><a href="/es/flow.html#运行环境api" class="sidebar-link">运行环境api</a></li></ul></li></ul></li><li><a href="/es/js-better.html" class="sidebar-link">JS性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/js-better.html#js性能优化" class="sidebar-link">JS性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/js-better.html#什么是性能优化" class="sidebar-link">什么是性能优化</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#js的内存管理" class="sidebar-link">JS的内存管理</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#js的垃圾回收" class="sidebar-link">JS的垃圾回收</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#gc的定义与作用" class="sidebar-link">GC的定义与作用</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#gc里面的垃圾" class="sidebar-link">GC里面的垃圾</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#gc算法" class="sidebar-link">GC算法</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#常见的gc算法" class="sidebar-link">常见的GC算法</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#引用计数算法" class="sidebar-link">引用计数算法</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#标记清除算法" class="sidebar-link">标记清除算法</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#标记整理算法" class="sidebar-link">标记整理算法</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#v8介绍" class="sidebar-link">V8介绍</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#v8的垃圾回收" class="sidebar-link">v8的垃圾回收</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#使用performance" class="sidebar-link">使用performance</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#如何判断是否存在频繁的gc" class="sidebar-link">如何判断是否存在频繁的GC</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#频繁gc的带来的问题" class="sidebar-link">频繁GC的带来的问题</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#代码优化介绍" class="sidebar-link">代码优化介绍</a></li><li class="sidebar-sub-header"><a href="/es/js-better.html#遍历对象" class="sidebar-link">遍历对象</a></li></ul></li></ul></li><li><a href="/es/project.html" aria-current="page" class="active sidebar-link">前端工程化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/project.html#前端工程化" class="sidebar-link">前端工程化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/project.html#前端工程化的目的" class="sidebar-link">前端工程化的目的</a></li><li class="sidebar-sub-header"><a href="/es/project.html#前端工程化的表现" class="sidebar-link">前端工程化的表现</a></li><li class="sidebar-sub-header"><a href="/es/project.html#一些成熟的工程化集成" class="sidebar-link">一些成熟的工程化集成</a></li><li class="sidebar-sub-header"><a href="/es/project.html#脚手架工具" class="sidebar-link">脚手架工具</a></li><li class="sidebar-sub-header"><a href="/es/project.html#常用的脚手架工具" class="sidebar-link">常用的脚手架工具</a></li><li class="sidebar-sub-header"><a href="/es/project.html#yeoman的使用" class="sidebar-link">yeoman的使用</a></li><li class="sidebar-sub-header"><a href="/es/project.html#自定义generator" class="sidebar-link">自定义generator</a></li><li class="sidebar-sub-header"><a href="/es/project.html#创建一个vue-js的脚手架" class="sidebar-link">创建一个vue.js的脚手架</a></li><li class="sidebar-sub-header"><a href="/es/project.html#plop脚手架" class="sidebar-link">plop脚手架</a></li><li class="sidebar-sub-header"><a href="/es/project.html#plop的使用" class="sidebar-link">plop的使用</a></li><li class="sidebar-sub-header"><a href="/es/project.html#使用plop在react中创建组件" class="sidebar-link">使用plop在react中创建组件</a></li><li class="sidebar-sub-header"><a href="/es/project.html#脚手架的工具原理" class="sidebar-link">脚手架的工具原理</a></li><li class="sidebar-sub-header"><a href="/es/project.html#脚手架具体实现" class="sidebar-link">脚手架具体实现</a></li><li class="sidebar-sub-header"><a href="/es/project.html#自动化构建" class="sidebar-link">自动化构建</a></li><li class="sidebar-sub-header"><a href="/es/project.html#自动化构建初体验" class="sidebar-link">自动化构建初体验</a></li><li class="sidebar-sub-header"><a href="/es/project.html#常用的自动化构建工具" class="sidebar-link">常用的自动化构建工具</a></li><li class="sidebar-sub-header"><a href="/es/project.html#grunt的基本使用" class="sidebar-link">grunt的基本使用</a></li><li class="sidebar-sub-header"><a href="/es/project.html#grunt常用插件的使用" class="sidebar-link">grunt常用插件的使用</a></li><li class="sidebar-sub-header"><a href="/es/project.html#gulp的使用" class="sidebar-link">gulp的使用</a></li><li class="sidebar-sub-header"><a href="/es/project.html#创建项目目录并进入" class="sidebar-link" style="padding-left:3rem;">创建项目目录并进入</a></li><li class="sidebar-sub-header"><a href="/es/project.html#在项目目录下创建-package-json-文件" class="sidebar-link" style="padding-left:3rem;">在项目目录下创建 package.json 文件</a></li><li class="sidebar-sub-header"><a href="/es/project.html#安装-gulp-作为开发时依赖项" class="sidebar-link" style="padding-left:3rem;">安装 gulp，作为开发时依赖项</a></li><li class="sidebar-sub-header"><a href="/es/project.html#创建-gulpfile-文件" class="sidebar-link" style="padding-left:3rem;">创建 gulpfile 文件</a></li><li class="sidebar-sub-header"><a href="/es/project.html#测试" class="sidebar-link" style="padding-left:3rem;">测试</a></li><li class="sidebar-sub-header"><a href="/es/project.html#gulp的组合任务" class="sidebar-link" style="padding-left:3rem;">gulp的组合任务</a></li><li class="sidebar-sub-header"><a href="/es/project.html#测试-2" class="sidebar-link" style="padding-left:3rem;">测试</a></li><li class="sidebar-sub-header"><a href="/es/project.html#gulp的异步任务" class="sidebar-link" style="padding-left:3rem;">gulp的异步任务</a></li><li class="sidebar-sub-header"><a href="/es/project.html#gulp的核心工作原理" class="sidebar-link">gulp的核心工作原理</a></li><li class="sidebar-sub-header"><a href="/es/project.html#gulp中关系文件的api" class="sidebar-link">gulp中关系文件的API</a></li><li class="sidebar-sub-header"><a href="/es/project.html#fis-fis3" class="sidebar-link" style="padding-left:3rem;">fis(fis3)</a></li></ul></li></ul></li><li><a href="/es/gulp-demo.html" class="sidebar-link">使用gulp构建一个web项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#使用gulp构建一个web项目" class="sidebar-link">使用gulp构建一个web项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#安装gulp的依赖" class="sidebar-link" style="padding-left:3rem;">安装gulp的依赖</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#使用gulp-sass插件对样式文件做处理" class="sidebar-link" style="padding-left:3rem;">使用gulp-sass插件对样式文件做处理</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#配置gulpfile-js文件" class="sidebar-link" style="padding-left:3rem;">配置gulpfile.js文件</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#测试" class="sidebar-link" style="padding-left:3rem;">测试</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#使用gulp-babel转换es语法-安装依赖" class="sidebar-link" style="padding-left:3rem;">使用gulp-babel转换ES语法，安装依赖</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#在gulpfile-js中加入下面的内容" class="sidebar-link" style="padding-left:3rem;">在gulpfile.js中加入下面的内容</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#测试-2" class="sidebar-link" style="padding-left:3rem;">测试</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#使用gulp-swim处理html模版文件" class="sidebar-link" style="padding-left:3rem;">使用gulp-swim处理html模版文件</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#安装gulp-swim的依赖" class="sidebar-link" style="padding-left:3rem;">安装gulp-swim的依赖</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#修改gulpfile-js文件" class="sidebar-link" style="padding-left:3rem;">修改gulpfile.js文件</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#测试-3" class="sidebar-link" style="padding-left:3rem;">测试</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#让上面的三个任务同时执行" class="sidebar-link" style="padding-left:3rem;">让上面的三个任务同时执行</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#测试-4" class="sidebar-link" style="padding-left:3rem;">测试</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#处理图片和字体文件" class="sidebar-link" style="padding-left:3rem;">处理图片和字体文件</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#复制public下的文件" class="sidebar-link" style="padding-left:3rem;">复制public下的文件</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#清除dist目录下的文件" class="sidebar-link" style="padding-left:3rem;">清除dist目录下的文件</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#自动加载插件" class="sidebar-link" style="padding-left:3rem;">自动加载插件</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#构建一个开发服务器" class="sidebar-link" style="padding-left:3rem;">构建一个开发服务器</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#处理生产环境的路径问题" class="sidebar-link" style="padding-left:3rem;">处理生产环境的路径问题</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#删除gulpfile中不需要到处的任务" class="sidebar-link" style="padding-left:3rem;">删除gulpfile中不需要到处的任务</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#自动化工作流的复用" class="sidebar-link" style="padding-left:3rem;">自动化工作流的复用</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#工作流的封装" class="sidebar-link" style="padding-left:3rem;">工作流的封装</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#发布我们的包到npm" class="sidebar-link" style="padding-left:3rem;">发布我们的包到npm</a></li><li class="sidebar-sub-header"><a href="/es/gulp-demo.html#在项目中使用我们发布的包" class="sidebar-link" style="padding-left:3rem;">在项目中使用我们发布的包</a></li></ul></li></ul></li><li><a href="/es/this.html" class="sidebar-link">this 的指向</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/es/module.html" class="sidebar-link">模块化的发展历程</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/es/webpack.html" class="sidebar-link">webpack</a><ul class="sidebar-sub-headers"></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="前端工程化"><a href="#前端工程化" class="header-anchor">#</a> 前端工程化</h2> <h3 id="前端工程化的目的"><a href="#前端工程化的目的" class="header-anchor">#</a> 前端工程化的目的</h3> <ul><li><p>随着前端的发展，现在的前端应用已经不像以前只是为了后端提供视图模版。</p></li> <li><p>由于前端项目日益复杂，前端项目中面临着许多问题</p> <ul><li>想要使用ES6+的新特性，但是有兼容性问题</li> <li>想要使用更具有表达力的Less、Scss、PostCss等增强css,但是运行环境不能直接支持</li> <li>想要使用模块化方式提高项目的可维护性，但是运行环境不支持</li> <li>部署上线前需要手动压缩代码和资源文件,部署过程中需要手动上传代码到服务器</li> <li>多人协作时无法硬性统一大家的编码风格，从仓库pull回来的代码质量无法保证</li> <li>部分功能开发时需要等待后端接口提前完成</li></ul></li> <li><p>前端工程化主要解决了的问题</p> <p><img src="/frontEnd/problems.png" alt="problems"></p></li></ul> <h3 id="前端工程化的表现"><a href="#前端工程化的表现" class="header-anchor">#</a> 前端工程化的表现</h3> <ul><li>一切以提高效率、降低成本、质量保证为目的的手段都属于工程化</li> <li>项目工程化不等于使用某个工具</li> <li>Node.js是前端工程化的基石</li> <li>项目中的具体表现</li></ul> <p><img src="/frontEnd/project.png" alt="project"></p> <ul><li>创建项目:
<ul><li>创建项目结构</li> <li>创建特定类型文件</li></ul></li> <li>编码
<ul><li>格式化代码</li> <li>校验代码风格</li> <li>编译/构建/打包</li></ul></li> <li>预览/测试
<ul><li>Web Server/mock</li> <li>Live Reloading/HMR</li> <li>Source Map</li></ul></li> <li>提交
<ul><li>git Hooks</li> <li>Lint-staged</li> <li>持续集成</li></ul></li> <li>部署
<ul><li>CI/CD</li> <li>自动部署发布</li></ul></li></ul> <h3 id="一些成熟的工程化集成"><a href="#一些成熟的工程化集成" class="header-anchor">#</a> 一些成熟的工程化集成</h3> <ul><li>create-react-app</li> <li>vue-cli</li> <li>angular-cli</li> <li>gatsby-cli</li></ul> <h3 id="脚手架工具"><a href="#脚手架工具" class="header-anchor">#</a> 脚手架工具</h3> <ul><li>脚手架工具的本质作用：创建项目基础结构、提供项目规范和约定
<ul><li>相同的组织结构</li> <li>相同的开发范式</li> <li>相同的模块依赖</li> <li>相同的工具配置</li> <li>相同的基础代码</li></ul></li></ul> <h3 id="常用的脚手架工具"><a href="#常用的脚手架工具" class="header-anchor">#</a> 常用的脚手架工具</h3> <ul><li>create-react-app、vue-cli、angular-cli特定框架的脚手架</li> <li>yeoman是通用的脚手架工具，可以用来生成特定模版的脚手架</li></ul> <h3 id="yeoman的使用"><a href="#yeoman的使用" class="header-anchor">#</a> yeoman的使用</h3> <ol><li><p>全局安装yeoman的命令行工具</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># yarn global add yo</span>
<span class="token function">npm</span> <span class="token function">install</span> -g yo 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>安装一个generator,yo会使用generator生成特定类型的项目</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#yarn global add generator-node</span>
<span class="token function">npm</span> <span class="token function">install</span> -g generator-node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>进入要生成项目的文件夹下，使用<code>yo generator</code>去创建项目,回答完制定的问题后，就可以创建一个项目</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> node_sample
yo node
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>使用generator的sub generator去为已有的项目添加一些新的配置文件或者特性，如generator-node有一个sub  generator叫cli，我们可以使用它将项目变成一个cli应用。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>yo node:cli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>运行后会在package.json中新增如下的文件</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code> <span class="token property">&quot;bin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lib/cli.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;meow&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.7.0&quot;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>安装开发依赖并链接一个包到全局使用</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 安装依赖</span>
<span class="token function">yarn</span>

<span class="token function">yarn</span> <span class="token function">link</span>
<span class="token comment"># 若不成功可尝试使用npm link,安装时刚开始yarn link确实不可用，但是用了npm link后，在回过来使用yarn link确实可以了 </span>
node_sample --help 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>并不是每个generator都有sub generator,下面是generator-node的sub generator.</p> <ul><li><code>node:boilerplate</code></li> <li><code>node:cli</code></li> <li><code>node:editorconfig</code></li> <li><code>node:eslint</code></li> <li><code>node:git</code></li> <li><code>node:readme</code></li></ul> <h3 id="自定义generator"><a href="#自定义generator" class="header-anchor">#</a> 自定义generator</h3></li></ol> <ul><li><p>yeoman的generator本质上是一个npm模块</p></li> <li><p>yeoman的generator有自己的命名规则，自定义generator必须遵从这个规则,</p></li> <li><p>generator必须以generator-开头，基本形式为generator-name</p></li> <li><p>自定义generator是对整个包的文件夹也是有要求的</p> <ul><li><p><img src="/frontEnd/generator.png" alt="generator"></p></li> <li><p>上面的是只有一个generator的，下面的是包含其他的sub generator的</p></li> <li><p>yeoman-generator包中提供了一个generator的基类，提供了一些声明周期方法，可以帮助创建生成器</p></li> <li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> generator-sample
<span class="token builtin class-name">cd</span> generator-sample
<span class="token function">mkdir</span> app
<span class="token builtin class-name">cd</span> app
<span class="token function">touch</span> index.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * yeoman-generator中导出一个生成器的基类，基类中提供了生命周期函数和一些方法
 * index.js 
 */</span>

<span class="token keyword">const</span> Generator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yeoman-generator'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> Generator <span class="token punctuation">{</span>
	<span class="token function">writing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//生成文件阶段调用此方法</span>
		<span class="token comment">// 向项目的目录中写入文件</span>
		<span class="token comment">// wirte方法接受两个参数：一个生成的文件的绝对路径，一个文件的内容</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>fs<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">destinationPath</span><span class="token punctuation">(</span><span class="token string">'temp.txt'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><div class="language- line-numbers-mode"><pre class="language-text"><code>npm link
mkdir my-proj &amp; cd my-proj
yo sample
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>使用模版创建文件</p> <ul><li><p>generator可以使用模版去创建一个复杂的文件</p></li> <li><p>模版文件完全遵守ejs模版引擎的规则</p></li> <li><p>模版文件需要放置在app/templates/ 下，下面是一个模版文件foo.txt</p></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code>这是一个模版文件

<span class="token operator">&lt;</span><span class="token operator">%=</span> title <span class="token operator">%</span><span class="token operator">&gt;</span>



<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token keyword">if</span><span class="token punctuation">(</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token operator">%</span><span class="token operator">&gt;</span>
哈哈哈
<span class="token operator">&lt;</span><span class="token operator">%</span> <span class="token punctuation">}</span> <span class="token operator">%</span><span class="token operator">&gt;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>修改index.js</p></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * yeoman-generator中导出一个生成器的基类，基类中提供了生命周期函数和一些方法
 *
 */</span>

<span class="token keyword">const</span> Generator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yeoman-generator'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> Generator <span class="token punctuation">{</span>
	<span class="token function">writing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//生成文件阶段调用此方法</span>
		<span class="token comment">// 向项目的目录中写入文件</span>
		<span class="token comment">// wirte方法接受两个参数：一个生成的文件的绝对路径，一个文件的内容</span>
		<span class="token comment">//this.fs.write(this.destinationPath('temp.txt'), Math.random().toString())</span>
		<span class="token comment">// 模版文件的路径</span>
		<span class="token keyword">const</span> temp <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">templatePath</span><span class="token punctuation">(</span><span class="token string">'foo.txt'</span><span class="token punctuation">)</span>

		<span class="token comment">// 输出目标的路径</span>
		<span class="token keyword">const</span> output <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">destinationPath</span><span class="token punctuation">(</span><span class="token string">'foo.txt'</span><span class="token punctuation">)</span>

		<span class="token comment">//模版数据上下文</span>
		<span class="token keyword">const</span> contents <span class="token operator">=</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">'foo.txt'</span><span class="token punctuation">,</span> success<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>

		<span class="token keyword">this</span><span class="token punctuation">.</span>fs<span class="token punctuation">.</span><span class="token function">copyTpl</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> output<span class="token punctuation">,</span> contents<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div></li> <li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">cd</span> my-proj
// 重新创建文件
yo sample
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul></li> <li><p>创建模版时接受用户的输入</p> <ul><li><div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span> &lt;%= name %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>&lt;%= name %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><p>上面是一个bar.html文件，我们希望在用户创建模版时根据用户的输入填充模版的名称</p></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token comment">/**
index.js
*/</span>
<span class="token keyword">const</span> Generator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yeoman-generator'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> Generator <span class="token punctuation">{</span>
	<span class="token function">prompting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// 创建模版时提问</span>
		<span class="token comment">//https://github.com/SBoudrias/Inquirer.js/blob/master/README.md</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			type<span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
			message<span class="token operator">:</span> <span class="token string">'Please input your file name!'</span><span class="token punctuation">,</span>
			<span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'project'</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">answer</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">//answer = { name: 'val' }</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>answer <span class="token operator">=</span> answer
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">writing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">//生成文件阶段调用此方法</span>
		<span class="token comment">// 向项目的目录中写入文件</span>
		<span class="token comment">// wirte方法接受两个参数：一个生成的文件的绝对路径，一个文件的内容</span>
		<span class="token comment">//this.fs.write(this.destinationPath('temp.txt'), Math.random().toString())</span>
		<span class="token comment">// 模版文件的路径</span>
		<span class="token comment">// const temp = this.templatePath('foo.txt')</span>
		<span class="token comment">// // 输出目标的路径</span>
		<span class="token comment">// const output = this.destinationPath('foo.txt')</span>
		<span class="token comment">// //模版数据上下文</span>
		<span class="token comment">// const contents = { title: 'foo.txt', success: true }</span>
		<span class="token comment">// this.fs.copyTpl(temp, output, contents)</span>

		<span class="token keyword">const</span> temp <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">templatePath</span><span class="token punctuation">(</span><span class="token string">'bar.html'</span><span class="token punctuation">)</span>
		<span class="token comment">// 输出目标的路径</span>
		<span class="token keyword">const</span> output <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">destinationPath</span><span class="token punctuation">(</span><span class="token string">'bar.html'</span><span class="token punctuation">)</span>
		<span class="token comment">//模版数据上下文</span>
		<span class="token keyword">const</span> contents <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>answer
		<span class="token keyword">this</span><span class="token punctuation">.</span>fs<span class="token punctuation">.</span><span class="token function">copyTpl</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> output<span class="token punctuation">,</span> contents<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div></li> <li><div class="language- line-numbers-mode"><pre class="language-text"><code>去根据模版生成文件
yo sample
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul></li></ul> <h3 id="创建一个vue-js的脚手架"><a href="#创建一个vue-js的脚手架" class="header-anchor">#</a> 创建一个vue.js的脚手架</h3> <ul><li><p>首先创建一个生成器目录generator-my-vue，进入该模块，安装yeoman的依赖文件yeoman-generator.</p></li> <li><p>将我们已经定义好的模版文件copy到app/template目录下面,将要修改的文件定义成ejs的模版引擎</p> <ul><li><p>&lt;%%= BASE_URL %是不需要转移的</p></li> <li><div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge,chrome=1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>renderer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>webkit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>icon<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>&lt;%%= BASE_URL %&gt;favicon.ico<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>&lt;%= name %&gt;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li></ul></li> <li><p>在app/index.js中将目录文件引入模版文件</p></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token keyword">const</span> Generator <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'yeoman-generator'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> Generator <span class="token punctuation">{</span>
	<span class="token comment">// 接受用户的输入</span>
	<span class="token function">prompting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			type<span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
			massage<span class="token operator">:</span> <span class="token string">'please input your name of project'</span><span class="token punctuation">,</span>
			<span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'vue-demo'</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">answer</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">//answer ={ name:'your input'}</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>answer <span class="token operator">=</span> answer
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token function">writing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> templates <span class="token operator">=</span> <span class="token punctuation">[</span>
			<span class="token string">'build/index.js'</span><span class="token punctuation">,</span>
			<span class="token string">'public/favicon.ico'</span><span class="token punctuation">,</span>
			<span class="token string">'public/index.html'</span><span class="token punctuation">,</span>
			<span class="token string">'src/App.vue'</span><span class="token punctuation">,</span>
			<span class="token string">'src/main.js'</span><span class="token punctuation">,</span>
			<span class="token string">'babel.config.js'</span><span class="token punctuation">,</span>
			<span class="token string">'jsconfig.json'</span><span class="token punctuation">,</span>
			<span class="token string">'package-lock.json'</span><span class="token punctuation">,</span>
			<span class="token string">'package.json'</span><span class="token punctuation">,</span>
			<span class="token string">'postcss.config.js'</span><span class="token punctuation">,</span>
			<span class="token string">'vue.config.js'</span><span class="token punctuation">,</span>
			<span class="token string">'README.md'</span>
		<span class="token punctuation">]</span>

		templates<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token keyword">this</span><span class="token punctuation">.</span>fs<span class="token punctuation">.</span><span class="token function">copyTpl</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">templatePath</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">destinationPath</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>answer<span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div></li> <li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 将包引入到全局</span>
<span class="token function">npm</span> <span class="token function">link</span>
//
<span class="token function">mkdir</span> my-vue-project <span class="token operator">&amp;</span> <span class="token builtin class-name">cd</span> my-vue-project
// 创建一个项目
yo my-vue
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>发布我们的generator到npm</p> <ul><li>创建一个git仓库，并向远端(github)提交一次代码</li> <li>使用npm publish去发布我们的包</li> <li>发布成功后可以去npm的官方查看我们的包</li> <li>npm发布的时候需要登陆npm账号，可以通过npm adduser去添加账户</li> <li>注册的npm账户需要验证邮箱，同时报名不能和已经存在的报名相同，否则会发布失败</li></ul></li></ul> <h3 id="plop脚手架"><a href="#plop脚手架" class="header-anchor">#</a> plop脚手架</h3> <ul><li>plop是一个小型的脚手架工具</li> <li>主要的作用是在项目中创建相同类型的文件</li></ul> <h3 id="plop的使用"><a href="#plop的使用" class="header-anchor">#</a> plop的使用</h3> <ul><li>将plop作为开发依赖在项目中安装</li> <li>在项目中创建一个plopfile.js文件</li> <li>在plop file.js中定义脚手架任务</li> <li>在plop-templates/编写用于生成特定类型文件的模版</li> <li>通过plop的提供的cli执行脚手架任务(npx plop /yarn plop)</li></ul> <h3 id="使用plop在react中创建组件"><a href="#使用plop在react中创建组件" class="header-anchor">#</a> 使用plop在react中创建组件</h3> <ul><li><p>使用create-react-app生成一个项目</p></li> <li><p>在项目中安装开发依赖plop,配置入口文件plopfile.js</p> <ul><li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> -D plop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * plop的入口文件，需要导出一个函数
 * 函数执行的时候时会传入plop对象，用于创建生成器任务
 */</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">plop</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">/**
	 * 第一个参数时生成器的名字
	 * 第二个参数用于描述生成器的对象
	 */</span>
	plop<span class="token punctuation">.</span><span class="token function">setGenerator</span><span class="token punctuation">(</span><span class="token string">'component'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
		description<span class="token operator">:</span> <span class="token string">'create a react component'</span><span class="token punctuation">,</span>
		<span class="token comment">// 创建过程中的询问环节</span>
		prompts<span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token punctuation">{</span>
				type<span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
				name<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
				message<span class="token operator">:</span> <span class="token string">'component name'</span><span class="token punctuation">,</span>
				<span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'MyComponent'</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span><span class="token punctuation">,</span>

		actions<span class="token operator">:</span> <span class="token punctuation">[</span>
			<span class="token punctuation">{</span>
				<span class="token comment">// 生成模版环节</span>
				type<span class="token operator">:</span> <span class="token string">'add'</span><span class="token punctuation">,</span>
				<span class="token comment">// name 来自上面的答案,使用hbs的模版引擎</span>
				path<span class="token operator">:</span> <span class="token string">'src/components/{{name}}/{{name}}.js'</span><span class="token punctuation">,</span>
				templateFile<span class="token operator">:</span> <span class="token string">'plop-templates/component.js.hbs'</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">{</span>
				<span class="token comment">// 生成模版环节</span>
				type<span class="token operator">:</span> <span class="token string">'add'</span><span class="token punctuation">,</span>
				<span class="token comment">// name 来自上面的答案,使用hbs的模版引擎</span>
				path<span class="token operator">:</span> <span class="token string">'src/components/{{name}}/{{name}}.css'</span><span class="token punctuation">,</span>
				templateFile<span class="token operator">:</span> <span class="token string">'plop-templates/component.css.hbs'</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token punctuation">{</span>
				<span class="token comment">// 生成模版环节</span>
				type<span class="token operator">:</span> <span class="token string">'add'</span><span class="token punctuation">,</span>
				<span class="token comment">// name 来自上面的答案,使用hbs的模版引擎</span>
				path<span class="token operator">:</span> <span class="token string">'src/components/{{name}}/{{name}}.test.js'</span><span class="token punctuation">,</span>
				templateFile<span class="token operator">:</span> <span class="token string">'plop-templates/component.test.js.hbs'</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">]</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div></li></ul></li> <li><p>复制3个模版文件到plop-templates目录下</p> <ul><li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// component.css.hbs</span>
<span class="token punctuation">.</span><span class="token punctuation">{</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
<span class="token comment">//component.js.hbs</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string">'./{{name}}.css'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;{{name}}&quot;</span><span class="token operator">&gt;</span>

  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
<span class="token comment">//component.test.js.hbs</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./{{name}}'</span><span class="token punctuation">;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'renders without crashing'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> div<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ReactDOM<span class="token punctuation">.</span><span class="token function">unmountComponentAtNode</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div></li></ul></li> <li><p>使用<code>npx plop</code>命令去生成文件</p></li></ul> <h3 id="脚手架的工具原理"><a href="#脚手架的工具原理" class="header-anchor">#</a> 脚手架的工具原理</h3> <ul><li>脚手架是一个cli应用</li> <li>脚手架一般包含询问和根据模版生成文件两个过程</li></ul> <h3 id="脚手架具体实现"><a href="#脚手架具体实现" class="header-anchor">#</a> 脚手架具体实现</h3> <ul><li><p>创建一个目录cli-demo</p></li> <li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> init -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>修改package.json文件</p></li> <li><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
	<span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cli-demo&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;bin&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cli.js&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
	<span class="token property">&quot;author&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
	<span class="token property">&quot;license&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ISC&quot;</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// cli.js</span>


#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li> <li><p>执行命令将包链接到全局</p> <ul><li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">link</span>
<span class="token comment"># 执行 正常输出hello</span>
cli-demo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul></li> <li><p>修改cli.js</p> <ul><li><div class="language-js line-numbers-mode"><pre class="language-js"><code>#<span class="token operator">!</span><span class="token operator">/</span>usr<span class="token operator">/</span>bin<span class="token operator">/</span>env node

<span class="token comment">// Node CLI 应用入口文件必须要有这样的文件头</span>
<span class="token comment">// 如果是 Linux 或者 macOS 系统下还需要修改此文件的读写权限为 755</span>
<span class="token comment">// 具体就是通过 chmod 755 cli.js 实现修改</span>

<span class="token comment">// 脚手架的工作过程：</span>
<span class="token comment">// 1. 通过命令行交互询问用户问题</span>
<span class="token comment">// 2. 根据用户回答的结果生成文件</span>

<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> inquirer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'inquirer'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> ejs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ejs'</span><span class="token punctuation">)</span>

inquirer
	<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
		<span class="token punctuation">{</span>
			type<span class="token operator">:</span> <span class="token string">'input'</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
			message<span class="token operator">:</span> <span class="token string">'Project name?'</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">anwsers</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
		<span class="token comment">// console.log(anwsers)</span>
		<span class="token comment">// 根据用户回答的结果生成文件</span>

		<span class="token comment">// 模板目录</span>
		<span class="token keyword">const</span> tmplDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'templates'</span><span class="token punctuation">)</span>
		<span class="token comment">// 目标目录</span>
		<span class="token keyword">const</span> destDir <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

		<span class="token comment">// 将模板下的文件全部转换到目标目录</span>
		fs<span class="token punctuation">.</span><span class="token function">readdir</span><span class="token punctuation">(</span>tmplDir<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err
			files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">file</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token comment">// 通过模板引擎渲染文件</span>
				ejs<span class="token punctuation">.</span><span class="token function">renderFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>tmplDir<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">,</span> anwsers<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">throw</span> err

					<span class="token comment">// 将结果写入目标文件路径</span>
					fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>destDir<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div></li> <li><p>将模版文件放入到templates/</p></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// comnponet.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>

<span class="token keyword">import</span> <span class="token string">'./&lt;%= name %&gt;.css'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;&lt;%= name %&gt;&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>


<span class="token comment">// componnets.test.js</span>

<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">&lt;</span><span class="token operator">%=</span> name <span class="token operator">%</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> <span class="token string">'./&lt;%= name %&gt;'</span><span class="token punctuation">;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'renders without crashing'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;&lt;</span><span class="token operator">%=</span> name <span class="token operator">%</span><span class="token operator">&gt;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> div<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ReactDOM<span class="token punctuation">.</span><span class="token function">unmountComponentAtNode</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li> <li><p>在需要创建文件的目录下执行<code>cli-demo</code>去创建文件</p></li></ul></li></ul></li></ul> <h3 id="自动化构建"><a href="#自动化构建" class="header-anchor">#</a> 自动化构建</h3> <ul><li>自动化构建指的是利用机器去代替手工去完成代码转化的工作</li> <li>从源代码自动化构建到生产环境代码的过程叫自动化构建工作流</li> <li>自动化构建的目的是为了将运行环境不支持的语法、语言转化到可以直接在运行环境执行的代码，提高开发效率。</li></ul> <p><img src="/frontEnd/auto-build.png" alt="自动化构建"></p> <h3 id="自动化构建初体验"><a href="#自动化构建初体验" class="header-anchor">#</a> 自动化构建初体验</h3> <ul><li><p>在开发过程中使用scss代替css.</p></li> <li><p>首先在项目中创建一个index.html和index.sass文件</p> <ul><li><div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index.css<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>scss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div></li> <li><div class="language-scss line-numbers-mode"><pre class="language-scss"><code><span class="token property"><span class="token variable">$body-color</span></span><span class="token punctuation">:</span>red<span class="token punctuation">;</span>

<span class="token selector">h1 </span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token variable">$body-color</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li> <li><p>scss文件不能直接在浏览器中使用，我们使用sass(npm包)将scss编译成css.</p> <ul><li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> -D sass
npx sass index.scss index.css 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>在浏览器直接打开html文件可以看到我们样式生效了</p></li></ul></li> <li><p>但是我们可以看到每次都要手动去构建比较麻烦，我们可以使用<code>npm script</code>,在package.json中加入下面的代码</p> <ul><li><div class="language-json line-numbers-mode"><pre class="language-json"><code>....

<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sass index.scss index.css&quot;</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>

...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul></li> <li><p>同时我们还想代码可以在浏览器中直接打开</p> <ul><li><p>安装browser-sync</p> <ul><li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> -D browser-sync
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>在package.json中加入新的脚本</p> <ul><li><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;browser-sync .&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>上面的.代表当前目录，执行脚本会自动启动一个服务</p></li></ul></li></ul></li> <li><p>此外，我们还想在每次启动服务之前都先构建一次，可以使用npm钩子</p> <ul><li><p>在package.json中加入如下的代码</p></li> <li><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sass index.scss index.css&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;preserve&quot;</span><span class="token operator">:</span><span class="token string">&quot;npm run build&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;browser-sync .&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>preserve会在serve之前执行，所以当我们启动这个服务时总会先去构建一次scss文件</p></li></ul></li> <li><p>我们还想在修改scss文件之后可以自动构建，那么我们可以这么修改package.json文件</p> <ul><li><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sass index.scss index.css --watch&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;preserve&quot;</span><span class="token operator">:</span><span class="token string">&quot;npm run build&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;browser-sync .&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>此时执行npm run serve会发现不能启动一个新的服务,原因是加入--watch后阻塞后续命令的执行，为了让两个命令都执行，我们需要借助一个npm包</p></li> <li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> i -D npm-run-all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>然后重新修改package.json文件</p></li> <li><div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sass index.scss index.css --watch&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;browser-sync .&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;run-p build serve&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul></li> <li><p>使用上面的<code>npm run start</code>我们会发现改变了scss文件后重新生成了css文件，但是服务没有刷新去重新加载</p> <ul><li><p>为此我们需要服务去监听项目下css文件变化，我们可以修改脚本</p></li> <li><div class="language-json line-numbers-mode"><pre class="language-json"><code>	<span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sass index.scss index.css --watch&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;serve&quot;</span><span class="token operator">:</span> <span class="token string">&quot;browser-sync . --files \&quot;*.css\&quot;&quot;</span><span class="token punctuation">,</span>
		<span class="token property">&quot;start&quot;</span><span class="token operator">:</span> <span class="token string">&quot;run-p build serve&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>此时我们修改scss文件就会自动刷新页面</p></li></ul></li></ul> <h3 id="常用的自动化构建工具"><a href="#常用的自动化构建工具" class="header-anchor">#</a> 常用的自动化构建工具</h3> <ul><li><p>grunt</p> <ul><li>grunt的插件生态非常丰富，几乎支持所以你要想要的自动化任务</li> <li>grunt的构建过程是基于临时文件的，构建过程中每一步都会产生临时文件，下一个步骤读取这个临时文件继续执行其他的任务</li> <li>由于临时文件的原因需要频繁的io操作，所以当项目比较大的时候构建比较慢</li></ul></li> <li><p>gulp</p> <ul><li><p>gulp是基于流去实现的，相比grunt构建更快</p></li> <li><p>gulp支持同时多任务</p></li> <li><p>gulp的使用相比grunt也更简单直观，插件生态也同样丰富</p></li></ul></li> <li><p>FIS</p> <ul><li>FIS是一个大而全的构建工具，</li> <li>FIS对很多的需求都做了集成，可以很容易的完成资源加载、模块化开发、代码部署、性能优化等</li> <li>更适合新手</li></ul></li></ul> <h3 id="grunt的基本使用"><a href="#grunt的基本使用" class="header-anchor">#</a> grunt的基本使用</h3> <ul><li><p>创建一个项目grunt-sample,然后执行npm init去初始化package.json</p></li> <li><div class="language- line-numbers-mode"><pre class="language-text"><code>npm install -D grunt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>创建grunt的入口文件grunt file.js</p> <ul><li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 *
 * gruntfile.js是grunt的入口文件，让我们定义一些自动化任务
 * 需要导出一个函数，函数接受grunt作为形参，里面提供了一些构建任务可以用的api
 *
 */</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">grunt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 定义一个简单的任务</span>
	<span class="token comment">// 第一个参数是任务的名称</span>
	<span class="token comment">// npx grunt bar</span>
	grunt<span class="token punctuation">.</span><span class="token function">registerTask</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">//第二个参数是一个任务描述</span>
	grunt<span class="token punctuation">.</span><span class="token function">registerTask</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token string">'this is task'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token comment">// 定义一个默认任务</span>
	<span class="token comment">//  npx grunt</span>
	<span class="token comment">// grunt.registerTask('default', function () {</span>
	<span class="token comment">// 	console.log('this is default task')</span>
	<span class="token comment">// })</span>

	<span class="token comment">// 使用默认任务去串联其他的任务</span>

	grunt<span class="token punctuation">.</span><span class="token function">registerTask</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

	<span class="token comment">// 异步任务</span>
	<span class="token comment">// grunt的任务默认是同步执行的，所以不会执行console.log</span>
	grunt<span class="token punctuation">.</span><span class="token function">registerTask</span><span class="token punctuation">(</span><span class="token string">'async-task'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async task'</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token comment">// 想要执行异步的任务，需要使用this.async获取一个函数，执行这个函数grunt才回去结束任务</span>
	grunt<span class="token punctuation">.</span><span class="token function">registerTask</span><span class="token punctuation">(</span><span class="token string">'async-task'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> done <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async task'</span><span class="token punctuation">)</span>
			<span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div></li> <li><p>gruntfile.js是grunt的入口文件，让我们定义一些自动化任务</p></li> <li><p>gruntfile.js需要导出一个函数，函数接受grunt作为形参，里面提供了一些构建任务可以用的api</p></li> <li><p>grunt中使用grunt.registerTask()去注册任务。</p></li> <li><p>使用<code>npx grunt [taskName]</code>去执行任务，当为默认任务时可以省略任务的名称</p></li> <li><p>使用<code>npx grunt --help</code>可以查看到可以使用的任务名称</p></li> <li><p>grunt的任务默认是同步执行的，也就是说不会等待异步任务执行就会结束当前的任务</p></li> <li><p>想要执行一个异步任务，需要在异步任务结束时调用this.返回的回调函数去告知grunt接受任务。</p></li></ul></li> <li><p>grunt使用任务函数的返回值为false来标记任务失败，当任务失败后，后续的任务不会继续执行,可以用<code>npx grunt [taskName] --force</code>去执行后续的任务</p></li> <li><p>当为异步任务时，无法直接返回false来告诉grunt任务失败，但是我们可以借助this.async()返回的回调函数来传递失败信息给grunt.</p> <ul><li><div class="language-js line-numbers-mode"><pre class="language-js"><code>grunt<span class="token punctuation">.</span><span class="token function">registerTask</span><span class="token punctuation">(</span><span class="token string">'bad'</span><span class="token punctuation">,</span> <span class="token string">'this is task'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 异步使用done(false)来告知grunt任务执行失败</span>
	grunt<span class="token punctuation">.</span><span class="token function">registerTask</span><span class="token punctuation">(</span><span class="token string">'async-bad-task'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> done <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'async task'</span><span class="token punctuation">)</span>
			<span class="token function">done</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul></li> <li><p>使用grunt.initConfig()为任务添加选项，grunt.config()在具体的任务中获取配置选项</p> <ul><li><div class="language-js line-numbers-mode"><pre class="language-js"><code></code></pre> <div class="line-numbers-wrapper"></div></div></li></ul> <p>grunt.initConfig({
// foo在这里代表的是任务名
foo: {
baz: 123
}
})</p> <div class="language- extra-class"><pre><code>  grunt.registerTask('foo', function () {
  	console.log(grunt.config('foo.baz')) //123
  	console.log(grunt.config('foo').baz) //123
  })
</code></pre></div><div class="language- line-numbers-mode"><pre class="language-text"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>多目标任务</p> <ul><li><div class="language-js line-numbers-mode"><pre class="language-js"><code>grunt<span class="token punctuation">.</span><span class="token function">initConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		build<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token comment">// build任务的选项</span>
			options<span class="token operator">:</span> <span class="token punctuation">{</span>
				top<span class="token operator">:</span> <span class="token string">'top'</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			css<span class="token operator">:</span> <span class="token punctuation">{</span>
				options<span class="token operator">:</span> <span class="token punctuation">{</span>
					baz<span class="token operator">:</span> <span class="token string">'baz'</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// data</span>
			js<span class="token operator">:</span> <span class="token number">1</span> 
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	grunt<span class="token punctuation">.</span><span class="token function">registerMultiTask</span><span class="token punctuation">(</span><span class="token string">'build'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">target:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>target<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,data:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li> <li><p>上面使用grunt.registerMultiTask注册了一个build的多模式任务。</p></li> <li><p>多模式任务必须使用grunt.initConfig()方法去初始化目标任务，build对象中的options属性会作为任务选项，其他的键会成为子任务</p></li> <li><p>所以上面实质是注册了三个任务任务:build、build:css、build:js。</p></li> <li><p>使用<code>npx gurnt build</code>会执行两个子任务</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ npx grunt build
Running <span class="token string">&quot;build:css&quot;</span> <span class="token punctuation">(</span>build<span class="token punctuation">)</span> task
<span class="token punctuation">{</span> top: <span class="token string">'top'</span>, baz: <span class="token string">'baz'</span> <span class="token punctuation">}</span>
target:css,data:<span class="token punctuation">[</span>object Object<span class="token punctuation">]</span>

Running <span class="token string">&quot;build:js&quot;</span> <span class="token punctuation">(</span>build<span class="token punctuation">)</span> task
<span class="token punctuation">{</span> top: <span class="token string">'top'</span> <span class="token punctuation">}</span>
target:js,data:1

Done.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>子任务的this.options()和this.data由grunt.initConfig配置</p></li></ul></li> <li><p>grunt插件的使用</p> <ul><li><p>grunt的插件实际上对常用的构建任务的封装</p></li> <li><p>使用npm安装插件:<code>npm install grunt-contrib-clean --save-dev</code></p></li> <li><p>在gruntfile.js中使用:grunt.loadNpmTasks('grunt-contrib-clean');</p></li> <li><p>使用grunt.initConfig()添加插件配置：</p></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code>module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">grunt</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	<span class="token comment">// 使用grunt插件</span>
	grunt<span class="token punctuation">.</span><span class="token function">initConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		clean<span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token comment">// 删除当前目录下的所有txt文件</span>
			txt<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'*.txt'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
			<span class="token comment">// 删除src基src下子目录中的文件</span>
			src<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src/**'</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	grunt<span class="token punctuation">.</span><span class="token function">loadNpmTasks</span><span class="token punctuation">(</span><span class="token string">'grunt-contrib-clean'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li> <li><p><code>npx grunt [plugin-name]</code>运行任务：<code>npx grunt clean</code></p> <blockquote><p>grunt的插件一般<code>grunt-contrib-</code>/<code>grunt-</code>开头。</p></blockquote></li></ul></li></ul> <h3 id="grunt常用插件的使用"><a href="#grunt常用插件的使用" class="header-anchor">#</a> grunt常用插件的使用</h3> <ul><li><p>grunt-sass</p> <ul><li>编译sass到css</li></ul></li> <li><p>grunt-babel</p> <ul><li>将ES6语法编译ES5</li></ul></li> <li><p>grunt-contrib-watch</p></li> <li><p>检测文件的变化</p></li> <li><p>创建项目grunt-often-plugins,执行<code>npm init -y</code>创建package.json.</p></li> <li><p>安装grunt的依赖</p> <ul><li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev grunt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>安装grunt-sass的依赖</p> <ul><li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev node-sass grunt-sass
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>创建grunt的入口文件grunt file.js</p> <ul><li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> sass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'node-sass'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">grunt</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	grunt<span class="token punctuation">.</span><span class="token function">initConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		sass<span class="token operator">:</span> <span class="token punctuation">{</span>
			options<span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token comment">//  制定编译sass的模块</span>
				implementation<span class="token operator">:</span> sass<span class="token punctuation">,</span>
				sourceMap<span class="token operator">:</span> <span class="token boolean">true</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">//</span>
			dist<span class="token operator">:</span> <span class="token punctuation">{</span>
				files<span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token comment">// 目标文件：源文件</span>
					<span class="token string">'./dist/css/main.css'</span><span class="token operator">:</span> <span class="token string">'scss/main.scss'</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	grunt<span class="token punctuation">.</span><span class="token function">loadNpmTasks</span><span class="token punctuation">(</span><span class="token string">'grunt-sass'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li></ul></li> <li><p>安装grunt-babel的依赖</p> <ul><li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev grunt-babel @babel/core @babel/preset-env
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>在grunt-file中加入配置</p> <ul><li><div class="language-js line-numbers-mode"><pre class="language-js"><code></code></pre> <div class="line-numbers-wrapper"></div></div></li></ul> <p>const sass = require('node-sass')
module.exports = grunt =&gt; {
grunt.initConfig({
//sass任务
sass: {
options: {
//  制定编译sass的模块
implementation: sass,
sourceMap: true
},
//
dist: {
files: {
// 目标文件：源文件
'./dist/css/main.css': 'scss/main.scss'
}
}
},
// babel任务
babel: {
options: {
sourceMap: true,
presets: ['@babel/preset-env']
},
dist: {
files: {
// 目标文件：源文件
'dist/js/app.js': 'src/app.js'
}
}
}
})
grunt.loadNpmTasks('grunt-sass')
grunt.loadNpmTasks('grunt-babel')
}</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>安装grunt-contrib-watch的依赖</p> <ul><li><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> grunt-contrib-watch --save-dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>在gruntfile中加入如下的配置</p> <ul><li><div class="language-js line-numbers-mode"><pre class="language-js"><code></code></pre> <div class="line-numbers-wrapper"></div></div></li></ul> <p>watch: {
scripts: {
//检测文件的变化
files: ['src/<em>.js', 'scss/</em>.scss'],
// 文件变化执行的任务
tasks: ['babel', 'sass'],
options: {
spawn: false
}
}
}</p> <p>....
grunt.loadNpmTasks('grunt-contrib-watch')</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>每次都使用grunt.loadNpmTasks()加载grunt插件比较麻烦，我们可以使用load-grunt-tasks去自动加载grunt插件</p></li> <li><p>我们还可以将上面的任务配置到默认任务中方便启动</p></li> <li><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> sass <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'node-sass'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> loadGruntTasks <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'load-grunt-tasks'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">grunt</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
	grunt<span class="token punctuation">.</span><span class="token function">initConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token comment">//sass任务</span>
		sass<span class="token operator">:</span> <span class="token punctuation">{</span>
			options<span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token comment">//  制定编译sass的模块</span>
				implementation<span class="token operator">:</span> sass<span class="token punctuation">,</span>
				sourceMap<span class="token operator">:</span> <span class="token boolean">true</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token comment">//</span>
			dist<span class="token operator">:</span> <span class="token punctuation">{</span>
				files<span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token comment">// 目标文件：源文件</span>
					<span class="token string">'./dist/css/main.css'</span><span class="token operator">:</span> <span class="token string">'scss/main.scss'</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token comment">// babel任务</span>
		babel<span class="token operator">:</span> <span class="token punctuation">{</span>
			options<span class="token operator">:</span> <span class="token punctuation">{</span>
				sourceMap<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
				presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			dist<span class="token operator">:</span> <span class="token punctuation">{</span>
				files<span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token comment">// 目标文件：源文件</span>
					<span class="token string">'dist/js/app.js'</span><span class="token operator">:</span> <span class="token string">'src/app.js'</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		watch<span class="token operator">:</span> <span class="token punctuation">{</span>
			scripts<span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token comment">//检测文件的变化</span>
				files<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'src/*.js'</span><span class="token punctuation">,</span> <span class="token string">'scss/*.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				<span class="token comment">// 文件变化执行的任务</span>
				tasks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'babel'</span><span class="token punctuation">,</span> <span class="token string">'sass'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
				options<span class="token operator">:</span> <span class="token punctuation">{</span>
					spawn<span class="token operator">:</span> <span class="token boolean">false</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
	<span class="token comment">// grunt.loadNpmTasks('grunt-sass')</span>
	<span class="token comment">// grunt.loadNpmTasks('grunt-babel')</span>
	<span class="token comment">// grunt.loadNpmTasks('grunt-contrib-watch')</span>
	<span class="token comment">//  自动加载grunt插件</span>
	<span class="token function">loadGruntTasks</span><span class="token punctuation">(</span>grunt<span class="token punctuation">)</span>
	<span class="token comment">// 每次启动先执行一次sass和babel任务，文件变化的时候再执行sass和babel任务</span>
	grunt<span class="token punctuation">.</span><span class="token function">registerTask</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'sass'</span><span class="token punctuation">,</span> <span class="token string">'babel'</span><span class="token punctuation">,</span> <span class="token string">'watch'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div></li></ul> <h3 id="gulp的使用"><a href="#gulp的使用" class="header-anchor">#</a> gulp的使用</h3> <h4 id="创建项目目录并进入"><a href="#创建项目目录并进入" class="header-anchor">#</a> 创建项目目录并进入</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">mkdir</span> gulp-sample <span class="token operator">&amp;</span> <span class="token builtin class-name">cd</span> gulp sample
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="在项目目录下创建-package-json-文件"><a href="#在项目目录下创建-package-json-文件" class="header-anchor">#</a> 在项目目录下创建 package.json 文件</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> init -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="安装-gulp-作为开发时依赖项"><a href="#安装-gulp-作为开发时依赖项" class="header-anchor">#</a> 安装 gulp，作为开发时依赖项</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev gulp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="创建-gulpfile-文件"><a href="#创建-gulpfile-文件" class="header-anchor">#</a> 创建 gulpfile 文件</h4> <p>在项目大的根目录下创建一个名为 gulpfile.js 的文件，并在文件中输入以下内容：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/***
 *
 * gulp的入口文件
 *
 */</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">foo</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
	<span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">default</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'default task'</span><span class="token punctuation">)</span>
	<span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// gulp4.0之前注册任务</span>

<span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span>

gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'baz'</span><span class="token punctuation">)</span>
	<span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><ul><li>gulp的任务默认时异步执行的，需要调用done()去告诉gulp这个任务结束了。</li> <li>gulp4.0之前注册任务需要使用gulp.task()方法</li></ul> <h4 id="测试"><a href="#测试" class="header-anchor">#</a> 测试</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>npx gulp default foo baz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>gulp后面可以接多个任务名称，如果只想执行default任务，可以省略default。</li></ul> <h4 id="gulp的组合任务"><a href="#gulp的组合任务" class="header-anchor">#</a> gulp的组合任务</h4> <ul><li>gulp使用 <code>series()</code> 和 <code>parallel()</code> 来创建组合任务。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> series<span class="token punctuation">,</span> parallel <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'foo task'</span><span class="token punctuation">)</span>
	<span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'foo task'</span><span class="token punctuation">)</span>
	<span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 串行任务</span>
exports<span class="token punctuation">.</span>task1 <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> baz<span class="token punctuation">)</span>

exports<span class="token punctuation">.</span>task2 <span class="token operator">=</span> <span class="token function">parallel</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> baz<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="测试-2"><a href="#测试-2" class="header-anchor">#</a> 测试</h4> <p>执行task1任务，可以看到foo执行完成后baz才开始执行</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ npx gulp task1
<span class="token punctuation">[</span><span class="token number">17</span>:23:40<span class="token punctuation">]</span> Using gulpfile ~/js-code/auto-build/gulp-sample/gulpfile.js
<span class="token punctuation">[</span><span class="token number">17</span>:23:40<span class="token punctuation">]</span> Starting <span class="token string">'task1'</span><span class="token punctuation">..</span>.
<span class="token punctuation">[</span><span class="token number">17</span>:23:40<span class="token punctuation">]</span> Starting <span class="token string">'foo'</span><span class="token punctuation">..</span>.
foo task
<span class="token punctuation">[</span><span class="token number">17</span>:23:40<span class="token punctuation">]</span> Finished <span class="token string">'foo'</span> after <span class="token number">598</span> μs
<span class="token punctuation">[</span><span class="token number">17</span>:23:40<span class="token punctuation">]</span> Starting <span class="token string">'baz'</span><span class="token punctuation">..</span>.
foo task
<span class="token punctuation">[</span><span class="token number">17</span>:23:40<span class="token punctuation">]</span> Finished <span class="token string">'baz'</span> after <span class="token number">273</span> μs
<span class="token punctuation">[</span><span class="token number">17</span>:23:40<span class="token punctuation">]</span> Finished <span class="token string">'task1'</span> after <span class="token number">2.42</span> ms
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>执行task2任务，可以看到foo启动后baz也开始启动</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ npx gulp task2
<span class="token punctuation">[</span><span class="token number">17</span>:27:49<span class="token punctuation">]</span> Using gulpfile ~/js-code/auto-build/gulp-sample/gulpfile.js
<span class="token punctuation">[</span><span class="token number">17</span>:27:49<span class="token punctuation">]</span> Starting <span class="token string">'task2'</span><span class="token punctuation">..</span>.
<span class="token punctuation">[</span><span class="token number">17</span>:27:49<span class="token punctuation">]</span> Starting <span class="token string">'foo'</span><span class="token punctuation">..</span>.
<span class="token punctuation">[</span><span class="token number">17</span>:27:49<span class="token punctuation">]</span> Starting <span class="token string">'baz'</span><span class="token punctuation">..</span>.
foo task
<span class="token punctuation">[</span><span class="token number">17</span>:27:49<span class="token punctuation">]</span> Finished <span class="token string">'foo'</span> after <span class="token number">860</span> μs
foo task
<span class="token punctuation">[</span><span class="token number">17</span>:27:49<span class="token punctuation">]</span> Finished <span class="token string">'baz'</span> after <span class="token number">1.07</span> ms
<span class="token punctuation">[</span><span class="token number">17</span>:27:49<span class="token punctuation">]</span> Finished <span class="token string">'task2'</span> after <span class="token number">2.25</span> ms
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="gulp的异步任务"><a href="#gulp的异步任务" class="header-anchor">#</a> gulp的异步任务</h4> <p>gulp中所有任务都是异步执行的，任务结束后如何通知gulp这个任务接受了 ，常用的有下面几种方式</p> <ul><li>执行回调函数</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
exports<span class="token punctuation">.</span><span class="token function-variable function">callback</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done task'</span><span class="token punctuation">)</span>
	<span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">callback_error</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done task'</span><span class="token punctuation">)</span>
	<span class="token function">done</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'task failed'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>当任务执行失败时可以通过回调函数传递一个错误给gulp.</p> <ul><li>使用promise的方式</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>exports<span class="token punctuation">.</span><span class="token function-variable function">promise</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise task'</span><span class="token punctuation">)</span>
	<span class="token comment">//  传递的值会被忽略</span>
	<span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'helo'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">promise_error</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise task'</span><span class="token punctuation">)</span>
	<span class="token comment">//  传递的值会被忽略</span>
	<span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'task failed'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>传递给成功的Promise值会被忽略，传递给失败的promise的值会传递给gulp.</p> <ul><li>await</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>exports<span class="token punctuation">.</span><span class="token function-variable function">await</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'await done'</span><span class="token punctuation">)</span>
	<span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>当promise变成成功状态下，是通知gulp任务接受</p> <ul><li>返回一个流的方式</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
exports<span class="token punctuation">.</span><span class="token function-variable function">stream</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> readStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'package.json'</span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> writeStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'temp.txt'</span><span class="token punctuation">)</span>
	readStream<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>writeStream<span class="token punctuation">)</span>
	<span class="token keyword">return</span> readStream
<span class="token punctuation">}</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">stream</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">done</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">const</span> readStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'package.json'</span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> writeStream <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'temp.txt'</span><span class="token punctuation">)</span>
	readStream<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>writeStream<span class="token punctuation">)</span>
	readStream<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>返回流的方式实质上和gulp自己监听流的end事件，当流的end时间被触发的时候，调用done通知gulp().</p> <h3 id="gulp的核心工作原理"><a href="#gulp的核心工作原理" class="header-anchor">#</a> gulp的核心工作原理</h3> <p>gulp是一个基于流的自动构建工具,它的工作原理就是读取文件到文件流，然后对文件流做转化操作，最终要文件流写入到目标文件中。</p> <p><img src="/frontEnd/gulp.png" alt="gulp的工作原理"></p> <p>例如我们需要压缩一个cssw文件,假如我们手动操作的过程，就是复制这个文件到一个可以压缩css的文件的网站对css压缩的结果复制到一个新的文件中。</p> <p>我们使用gulp来完成这个工作。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 *
 * 使用gulp来压缩css文件
 *
 */</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> Transform <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'stream'</span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">miniCss</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// 读取css文件</span>

	<span class="token keyword">const</span> read <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'./normalize.css'</span><span class="token punctuation">)</span>

	<span class="token comment">//创建一个转换流对流的内容做修改</span>

	<span class="token keyword">const</span> myTransform <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Transform</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token function">transform</span><span class="token punctuation">(</span><span class="token parameter">chunk<span class="token punctuation">,</span> encoding<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// 对流的内容做修改</span>
			<span class="token keyword">const</span> output <span class="token operator">=</span> chunk
				<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\s+</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\/\*.+?\*\/</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
			<span class="token function">callback</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span>

	<span class="token keyword">const</span> write <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'./normalize.min.css'</span><span class="token punctuation">)</span>
	read<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>myTransform<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>write<span class="token punctuation">)</span>
	<span class="token keyword">return</span> read
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="gulp中关系文件的api"><a href="#gulp中关系文件的api" class="header-anchor">#</a> gulp中关系文件的API</h3> <ul><li><a href="https://www.gulpjs.com.cn/docs/api/src/" target="_blank" rel="noopener noreferrer">src(globs, [options])<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>创建一个可读流，用于从文件系统读取 <a href="https://www.gulpjs.com.cn/docs/api/concepts#vinyl" target="_blank" rel="noopener noreferrer">Vinyl<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (Vinyl 是描述文件的元数据对象)对象。</li> <li>globs可以是一个字符串，也可以是一个字符串数组。</li> <li>gobs的字符串可以包含通配符，如<code>src/*.css</code>代表src文件下的所有css文件</li></ul></li> <li><a href="https://www.gulpjs.com.cn/docs/api/dest/" target="_blank" rel="noopener noreferrer">dest(directory, [options])<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <ul><li>创建一个用于将 <a href="https://www.gulpjs.com.cn/docs/api/concepts#vinyl" target="_blank" rel="noopener noreferrer">Vinyl<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 对象写入到文件系统的写入流。</li> <li>directory可以是一个代表写入文件的输出目录的路径字符串，也可以是一个函数。如果使用一个函数，该函数将与每个 Vinyl 对象一起调用，并且必须返回一个字符串目录路径。</li></ul></li></ul> <p>使用gulp提供的api完成对css文件的压缩构建</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>
<span class="token comment">/**
 *
 * 使用gulp提供的文件相关的api
 *
 */</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> dest <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> clean <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-clean-css'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> rename <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp-rename'</span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span><span class="token function-variable function">miniCss</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">//clean是一个转换流，用于css的压缩</span>
	<span class="token comment">// rename也是一个转换流，用于修改文件名(文件的元信息)</span>
	<span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'./normalize.css'</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">rename</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extname<span class="token operator">:</span> <span class="token string">'.min.css'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="fis-fis3"><a href="#fis-fis3" class="header-anchor">#</a> fis(fis3)</h4> <p>FIS3 是面向前端的工程构建工具。解决前端工程中性能优化、资源加载（异步、同步、按需、预加载、依赖管理、合并、内嵌）、模块化开发、自动化工具、开发规范、代码部署等问题。</p> <p><a href="http://fis.baidu.com/fis3/docs/beginning/intro.html" target="_blank" rel="noopener noreferrer">fis的使用文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>​</p> <p>​</p> <p>​</p> <p>​</p> <p>​</p> <p>​</p> <p>​</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/8/2021, 2:52:06 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/es/js-better.html" class="prev">
        JS性能优化
      </a></span> <span class="next"><a href="/es/gulp-demo.html">
        使用gulp构建一个web项目
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6fb23a83.js" defer></script><script src="/assets/js/2.b22280cb.js" defer></script><script src="/assets/js/40.6405a5c2.js" defer></script>
  </body>
</html>
